# bolo

A CLI tool that parses codebases using tree-sitter and emits dependency DAGs as JSON.

Walks source files, extracts functions, types, calls, and comments into a nested structure,
then cleans and consolidates per-file results into a single JSON array.

## Installation

**Quick install** (Linux / macOS):

```bash
curl -fsSL https://raw.githubusercontent.com/bharxhav/bolomoty/main/install.sh | bash
```

**From source:**

```bash
cargo install --git https://github.com/bharxhav/bolomoty.git
```

## Usage

```bash
bolo <COMMAND> [PATH] [OPTIONS]
```

### Commands

| Command | Language |
| ------- | -------- |
| `py`    | Python   |
| `rs`    | Rust     |

### Options

| Flag                  | Description                                  |
| --------------------- | -------------------------------------------- |
| `-o, --output <FILE>` | Output file (default: stdout)                |
| `-f, --force`         | Overwrite existing output                    |
| `--no-ignore`         | Include files ignored by `.gitignore`        |
| `--shallow`           | Only scan immediate directory                |
| `--dry-run`           | Show file count and exit                     |
| `-j, --jobs N`        | Parallel threads (default: 1, 0 = all cores) |
| `-h, --help`          | Print help                                   |
| `-V, --version`       | Print version                                |

### Dependency Graph

Generated by running `bolo rs src/` on itself.

Cross-module calls extracted from the JSON output:

```mermaid
graph LR
    subgraph main.rs
        Bolo[Bolo CLI]
        LangCmd
        Args
        main_fn[main]
        run
    end

    subgraph consolidate.rs
        folder
        recursive
    end

    subgraph clean.rs
        clean
        strip_comments
    end

    subgraph error.rs
        BoloError
    end

    subgraph pretty.rs
        pretty_error[error]
        pretty_warn[warn]
        pretty_success[success]
        pretty_neutral[neutral]
    end

    subgraph api/fs.rs
        File_struct[File]
        validate_path
        walk_dir
        matches_ext
        ensure_dir
        write_file
    end

    subgraph api/tree_sitter/mod.rs
        Lang[Lang trait]
        Syntax
        ASTNode
        Metadata
        ParseError
        metadata_from_span
    end

    subgraph api/tree_sitter/py.rs
        Python
        py_walk[walk]
        py_collect_imports[collect_imports]
        py_resolve_call[resolve_call]
    end

    subgraph api/tree_sitter/rs.rs
        Rust_struct[Rust]
        rs_walk[walk]
        rs_collect_imports[collect_imports]
        rs_resolve_call[resolve_call]
    end

    main_fn --> run
    main_fn --> pretty_error
    run --> validate_path
    run --> walk_dir
    run --> pretty_neutral
    run --> folder
    run --> recursive
    run --> write_file
    run --> pretty_success

    folder --> walk_dir
    folder --> clean
    recursive --> walk_dir
    recursive --> clean

    clean --> metadata_from_span
    clean --> strip_comments

    walk_dir --> matches_ext
    write_file --> ensure_dir

    Python -.->|impl| Lang
    Rust_struct -.->|impl| Lang
    Python --> py_collect_imports
    Python --> py_walk
    py_walk --> py_resolve_call
    Rust_struct --> rs_collect_imports
    Rust_struct --> rs_walk
    rs_walk --> rs_resolve_call
    py_walk --> metadata_from_span
    rs_walk --> metadata_from_span
```
